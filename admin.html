<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kingpin Pips Signals ☢️</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700&family=Exo+2:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Exo 2', sans-serif;
        }
        :root {
            --primary: #0f0f23;
            --secondary: #1a1a2e;
            --accent: #4a00e0;
            --highlight: #00f5d4;
            --danger: #f72585;
            --success: #4cc9f0;
            --warning: #f8961e;
            --text: #ffffff;
            --dark-text: #0f0f23;
        }
        body {
            background: var(--primary);
            color: var(--text);
            min-height: 100vh;
            padding: 20px;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(74, 0, 224, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(0, 245, 212, 0.1) 0%, transparent 20%);
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-bottom: 30px;
            border-bottom: 1px solid rgba(0, 245, 212, 0.3);
        }
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .logo i {
            font-size: 2.5rem;
            color: var(--highlight);
            text-shadow: 0 0 10px rgba(0, 245, 212, 0.7);
        }
        .logo h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(to right, var(--highlight), var(--success));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 1px;
        }
        .logo span {
            color: var(--danger);
            font-size: 1.8rem;
        }
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent), var(--highlight));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
        }
        .login-section {
            background: rgba(26, 26, 46, 0.8);
            border-radius: 15px;
            padding: 40px;
            max-width: 500px;
            margin: 50px auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(0, 245, 212, 0.2);
            backdrop-filter: blur(10px);
        }
        .login-section h2 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 1.8rem;
            color: var(--highlight);
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 1px;
        }
        .admin-login-toggle {
            text-align: center;
            margin-top: 20px;
            color: var(--highlight);
            cursor: pointer;
            font-weight: 500;
        }
        .admin-login-toggle:hover {
            text-decoration: underline;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--highlight);
        }
        .form-group input {
            width: 100%;
            padding: 14px 20px;
            border-radius: 8px;
            border: 1px solid rgba(0, 245, 212, 0.3);
            background: rgba(15, 15, 35, 0.5);
            color: var(--text);
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        .form-group input:focus {
            outline: none;
            border-color: var(--highlight);
            box-shadow: 0 0 0 3px rgba(0, 245, 212, 0.3);
        }
        .btn {
            padding: 14px 25px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-family: 'Orbitron', sans-serif;
        }
        .btn-primary {
            background: linear-gradient(135deg, var(--accent), #8e2de2);
            color: white;
            box-shadow: 0 5px 15px rgba(142, 45, 226, 0.4);
        }
        .btn-primary:hover {
            background: linear-gradient(135deg, #8e2de2, var(--accent));
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(142, 45, 226, 0.6);
        }
        .btn-logout {
            background: linear-gradient(135deg, var(--danger), #f72585);
            color: white;
            box-shadow: 0 5px 15px rgba(247, 37, 133, 0.4);
            width: auto;
            padding: 10px 20px;
        }
        .btn-logout:hover {
            background: linear-gradient(135deg, #f72585, var(--danger));
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(247, 37, 133, 0.6);
        }
        .signals-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }
        .signal-card {
            background: rgba(26, 26, 46, 0.8);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(0, 245, 212, 0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        .signal-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: linear-gradient(to bottom, var(--accent), var(--highlight));
        }
        .signal-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
            border-color: var(--highlight);
        }
        .signal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .signal-name {
            font-weight: 700;
            font-size: 1.3rem;
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 1px;
            color: var(--highlight);
        }
        .signal-status {
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }
        .status-open {
            background: rgba(76, 201, 240, 0.2);
            color: var(--success);
        }
        .status-closed {
            background: rgba(247, 37, 133, 0.2);
            color: var(--danger);
        }
        .signal-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .detail-item {
            display: flex;
            flex-direction: column;
        }
        .detail-label {
            font-size: 0.9rem;
            opacity: 0.7;
            margin-bottom: 5px;
            color: var(--highlight);
        }
        .detail-value {
            font-weight: 600;
            font-size: 1.2rem;
        }
        .profit {
            color: var(--success);
            text-shadow: 0 0 5px rgba(76, 201, 240, 0.5);
        }
        .loss {
            color: var(--danger);
            text-shadow: 0 0 5px rgba(247, 37, 133, 0.5);
        }
        .buy {
            color: var(--success);
        }
        .sell {
            color: var(--danger);
        }
        .signal-time {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-top: 15px;
            text-align: right;
            color: var(--highlight);
        }
        .signal-hits {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        .hit-item {
            flex: 1;
            padding: 8px;
            border-radius: 8px;
            text-align: center;
            font-weight: 600;
            font-size: 0.9rem;
        }
        .tp-hit {
            background: rgba(76, 201, 240, 0.2);
            color: var(--success);
            border: 1px solid var(--success);
        }
        .sl-hit {
            background: rgba(247, 37, 133, 0.2);
            color: var(--danger);
            border: 1px solid var(--danger);
        }
        .admin-panel {
            background: rgba(26, 26, 46, 0.8);
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
            border: 1px solid rgba(0, 245, 212, 0.2);
            backdrop-filter: blur(5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        .admin-panel h2 {
            margin-bottom: 25px;
            color: var(--highlight);
            display: flex;
            align-items: center;
            gap: 10px;
            font-family: 'Orbitron', sans-serif;
        }
        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: rgba(15, 15, 35, 0.5);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 1px solid rgba(0, 245, 212, 0.2);
        }
        .stat-value {
            font-size: 2.8rem;
            font-weight: 700;
            margin: 15px 0;
            background: linear-gradient(to right, var(--highlight), var(--success));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-family: 'Orbitron', sans-serif;
        }
        .stat-label {
            font-size: 1.1rem;
            opacity: 0.8;
            color: var(--highlight);
        }
        .admin-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        .admin-btn {
            padding: 18px;
            border-radius: 12px;
            background: rgba(15, 15, 35, 0.5);
            border: 1px solid rgba(0, 245, 212, 0.2);
            color: var(--text);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            font-size: 1.1rem;
        }
        .admin-btn:hover {
            background: rgba(74, 0, 224, 0.3);
            border-color: var(--highlight);
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        .admin-btn i {
            color: var(--highlight);
            font-size: 1.4rem;
        }
        .payment-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 15, 35, 0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        .payment-modal.active {
            opacity: 1;
            pointer-events: all;
        }
        .payment-content {
            background: var(--secondary);
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            padding: 40px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
            position: relative;
            transform: translateY(-30px);
            transition: transform 0.5s ease;
            border: 1px solid var(--accent);
        }
        .payment-modal.active .payment-content {
            transform: translateY(0);
        }
        .close-modal {
            position: absolute;
            top: 25px;
            right: 25px;
            font-size: 1.8rem;
            cursor: pointer;
            color: var(--highlight);
            transition: all 0.3s ease;
        }
        .close-modal:hover {
            color: var(--danger);
            transform: rotate(90deg);
        }
        .payment-content h3 {
            text-align: center;
            margin-bottom: 25px;
            color: var(--highlight);
            font-size: 1.8rem;
            font-family: 'Orbitron', sans-serif;
        }
        .payment-options {
            display: grid;
            gap: 20px;
            margin: 30px 0;
        }
        .payment-option {
            background: rgba(15, 15, 35, 0.5);
            border: 1px solid rgba(0, 245, 212, 0.2);
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .payment-option:hover {
            border-color: var(--highlight);
            background: rgba(74, 0, 224, 0.3);
        }
        .payment-option.selected {
            border-color: var(--highlight);
            background: rgba(74, 0, 224, 0.3);
            transform: scale(1.02);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        .payment-option h4 {
            color: var(--highlight);
            font-size: 1.4rem;
            margin-bottom: 10px;
            font-family: 'Orbitron', sans-serif;
        }
        .payment-option p {
            color: var(--text);
            opacity: 0.8;
        }
        .payment-details {
            background: rgba(15, 15, 35, 0.5);
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            border: 1px solid rgba(0, 245, 212, 0.2);
        }
        .payment-details h4 {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--highlight);
            font-family: 'Orbitron', sans-serif;
        }
        .payment-info {
            margin-bottom: 15px;
            padding-left: 30px;
        }
        .payment-info p {
            margin-bottom: 8px;
            color: var(--text);
        }
        .payment-info strong {
            color: var(--highlight);
        }
        .admin-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }
        .admin-contact {
            background: rgba(15, 15, 35, 0.5);
            border: 1px solid rgba(0, 245, 212, 0.2);
            border-radius: 15px;
            padding: 25px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .admin-contact:hover {
            transform: translateY(-5px);
            border-color: var(--highlight);
            background: rgba(74, 0, 224, 0.3);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        .admin-contact i {
            font-size: 2.5rem;
            color: var(--highlight);
        }
        .admin-contact h4 {
            color: var(--highlight);
            font-size: 1.3rem;
        }
        .admin-contact p {
            color: var(--text);
            opacity: 0.8;
        }
        .hidden {
            display: none;
        }
        .tab-container {
            margin-top: 20px;
        }
        .tabs {
            display: flex;
            border-bottom: 1px solid rgba(0, 245, 212, 0.2);
            margin-bottom: 30px;
        }
        .tab {
            padding: 15px 30px;
            cursor: pointer;
            opacity: 0.7;
            transition: all 0.3s ease;
            font-weight: 600;
            color: var(--text);
            position: relative;
        }
        .tab.active {
            opacity: 1;
            color: var(--highlight);
        }
        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(to right, var(--accent), var(--highlight));
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .pairs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        .pair-item {
            background: rgba(15, 15, 35, 0.5);
            border: 1px solid rgba(0, 245, 212, 0.2);
            border-radius: 12px;
            padding: 25px 15px;
            text-align: center;
            font-weight: 700;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            cursor: default;
            color: var(--highlight);
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 1px;
        }
        .pair-item:hover {
            transform: translateY(-5px);
            border-color: var(--highlight);
            background: rgba(74, 0, 224, 0.3);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        .online-users {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
        }
        .user-badge {
            background: rgba(15, 15, 35, 0.5);
            border: 1px solid rgba(0, 245, 212, 0.2);
            border-radius: 50px;
            padding: 8px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 500;
        }
        .user-badge::before {
            content: '';
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--success);
        }
        @media (max-width: 768px) {
            .login-section {
                padding: 30px 20px;
            }
            .admin-stats {
                grid-template-columns: 1fr;
            }
            .admin-buttons {
                grid-template-columns: 1fr;
            }
            .tabs {
                flex-wrap: wrap;
            }
            .tab {
                padding: 12px 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-crown"></i>
                <h1>KINGPIN <span>☢️</span> PIPS SIGNALS</h1>
            </div>
            <div class="user-info">
                <div class="user-avatar">KP</div>
                <button class="btn-logout hidden" id="logoutBtn"><i class="fas fa-power-off"></i> Logout</button>
            </div>
        </header>
        <!-- Login Section -->
        <section class="login-section" id="loginSection">
            <h2><i class="fas fa-user-secret"></i> USER ACCESS</h2>
            <div class="form-group">
                <label for="username"><i class="fas fa-user"></i> User ID</label>
                <input type="text" id="username" placeholder="Enter your User ID">
            </div>
            <div class="form-group">
                <label for="password"><i class="fas fa-key"></i> Password</label>
                <input type="password" id="password" placeholder="Enter your password">
            </div>
            <button class="btn btn-primary" id="loginBtn">ACCESS SIGNALS</button>
            <div class="admin-login-toggle" id="adminLoginToggle">
                <i class="fas fa-lock"></i> Admin Login
            </div>
        </section>
        <!-- Admin Login Section -->
        <section class="login-section hidden" id="adminLoginSection">
            <h2><i class="fas fa-user-crown"></i> ADMIN ACCESS</h2>
            <div class="form-group">
                <label for="adminUsername"><i class="fas fa-user"></i> Admin Username</label>
                <input type="text" id="adminUsername" placeholder="Enter admin username">
            </div>
            <div class="form-group">
                <label for="adminPassword"><i class="fas fa-key"></i> Admin Password</label>
                <input type="password" id="adminPassword" placeholder="Enter admin password">
            </div>
            <button class="btn btn-primary" id="adminLoginBtn">ACCESS ADMIN PANEL</button>
            <div class="admin-login-toggle" id="userLoginToggle">
                <i class="fas fa-user"></i> User Login
            </div>
        </section>
        <!-- Signals Section -->
        <section class="hidden" id="signalsSection">
            <div class="tabs">
                <div class="tab active" data-tab="signals">Signals</div>
                <div class="tab" data-tab="pairs">Trading Pairs</div>
            </div>
            <div class="tab-content active" id="signalsTab">
                <h2><i class="fas fa-bolt"></i> LIVE TRADING SIGNALS</h2>
                <div class="signals-grid" id="signalsGrid">
                    <!-- Signals will be loaded here -->
                </div>
            </div>
            <div class="tab-content" id="pairsTab">
                <h2><i class="fas fa-coins"></i> AVAILABLE TRADING PAIRS</h2>
                <div class="pairs-grid">
                    <div class="pair-item">Boom 1000</div>
                    <div class="pair-item">Crash 600</div>
                    <div class="pair-item">Boom 500</div>
                    <div class="pair-item">Crash 500</div>
                    <div class="pair-item">Crash 1000</div>
                    <div class="pair-item">Boom 900</div>
                    <div class="pair-item">Boom 600</div>
                    <div class="pair-item">Crash 300</div>
                    <div class="pair-item">GainX 1200</div>
                    <div class="pair-item">TraderX</div>
                    <div class="pair-item">GainX 400</div>
                    <div class="pair-item">GainX 600</div>
                    <div class="pair-item">GainX 800</div>
                    <div class="pair-item">GainX 999</div>
                    <div class="pair-item">PainX 1200</div>
                    <div class="pair-item">PainX 400</div>
                    <div class="pair-item">PainX 600</div>
                    <div class="pair-item">PainX 800</div>
                </div>
            </div>
        </section>
        <!-- Admin Section -->
        <section class="hidden" id="adminSection">
            <h2><i class="fas fa-user-crown"></i> ADMIN DASHBOARD</h2>
            <div class="admin-panel">
                <div class="admin-stats">
                    <div class="stat-card">
                        <div class="stat-label">Total Users</div>
                        <div class="stat-value" id="totalUsers">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Online Users</div>
                        <div class="stat-value" id="onlineUsers">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Active Signals</div>
                        <div class="stat-value" id="activeSignals">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Success Rate</div>
                        <div class="stat-value" id="successRate">0%</div>
                    </div>
                </div>
                <h3>Currently Online</h3>
                <div class="online-users" id="onlineUsersList">
                    <!-- Online users will appear here -->
                </div>
                <h3 style="margin-top: 30px;">User Management</h3>
                <div class="admin-controls">
                    <div class="admin-btn" id="addUserBtn">
                        <i class="fas fa-user-plus"></i>
                        Add User
                    </div>
                    <div class="admin-btn" id="editUserBtn">
                        <i class="fas fa-user-edit"></i>
                        Edit User
                    </div>
                    <div class="admin-btn" id="removeUserBtn">
                        <i class="fas fa-user-times"></i>
                        Remove User
                    </div>
                    <div class="admin-btn" id="resetPasswordBtn">
                        <i class="fas fa-key"></i>
                        Reset Password
                    </div>
                </div>
                <h3 style="margin-top: 30px;">Signal Management</h3>
                <div class="admin-controls">
                    <div class="admin-btn" id="addSignalBtn">
                        <i class="fas fa-plus-circle"></i>
                        Add Signal
                    </div>
                    <div class="admin-btn" id="editSignalBtn">
                        <i class="fas fa-edit"></i>
                        Edit Signal
                    </div>
                    <div class="admin-btn" id="removeSignalBtn">
                        <i class="fas fa-trash"></i>
                        Remove Signal
                    </div>
                    <div class="admin-btn" id="exportDataBtn">
                        <i class="fas fa-file-export"></i>
                        Export Data
                    </div>
                </div>
            </div>
        </section>
    </div>
    <!-- Payment Modal -->
    <div class="payment-modal" id="paymentModal">
        <div class="payment-content">
            <span class="close-modal" id="closeModal">&times;</span>
            <h3><i class="fas fa-shopping-cart"></i> PURCHASE ACCESS</h3>
            <p style="text-align: center; margin-bottom: 20px;">Your login credentials are invalid or expired. Please purchase a subscription package to access Kingpin Pips Signals.</p>
            <div class="payment-options">
                <div class="payment-option" data-package="1week">
                    <h4>1 Week Access</h4>
                    <p>$20 - Full signal access for 7 days</p>
                </div>
                <div class="payment-option" data-package="2weeks">
                    <h4>2 Weeks Access</h4>
                    <p>$25 - Full signal access for 14 days</p>
                </div>
                <div class="payment-option" data-package="1month">
                    <h4>1 Month Access</h4>
                    <p>$40 - Full signal access for 30 days</p>
                </div>
            </div>
            <div class="payment-details">
                <h4><i class="fas fa-wallet"></i> PAYMENT DETAILS</h4>
                <div class="payment-info">
                    <p><strong>InnBucks:</strong> 0782637207 (Tinashe Matongorere)</p>
                    <p><strong>EcoCash:</strong> +263 77 865 2739 (Michael Tanastwa)</p>
                </div>
                <p style="text-align: center; margin-top: 15px;">After payment, contact one of our admins via WhatsApp to activate your account.</p>
            </div>
            <div class="admin-buttons">
                <div class="admin-contact" id="admin1Contact">
                    <i class="fab fa-whatsapp"></i>
                    <h4>Admin 1 (Tinashe)</h4>
                    <p>+263782637207</p>
                </div>
                <div class="admin-contact" id="admin2Contact">
                    <i class="fab fa-whatsapp"></i>
                    <h4>Admin 2 (Michael)</h4>
                    <p>+263 77 865 2739</p>
                </div>
            </div>
            <button class="btn btn-primary" id="confirmPayment" style="margin-top: 30px;">I HAVE MADE PAYMENT</button>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    
    <script>
        // Initialize Firebase with your config
        const firebaseConfig = {
            apiKey: "AIzaSyD7Gy4vNofMOfDmnBpfZhgePqRVUcAVMuQ",
            authDomain: "kingpinpips.firebaseapp.com",
            projectId: "kingpinpips",
            storageBucket: "kingpinpips.firebasestorage.app",
            messagingSenderId: "265570358438",
            appId: "1:265570358438:web:dfbc1d96cc846b07e3d067",
            measurementId: "G-VYSGCL9MBD"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();

        // SET SESSION PERSISTENCE
        auth.setPersistence(firebase.auth.browserSessionPersistence)
            .then(() => {
                console.log("Auth persistence set to session");
            })
            .catch((error) => {
                console.error("Error setting auth persistence:", error);
            });

        // DOM Elements
        const loginSection = document.getElementById('loginSection');
        const adminLoginSection = document.getElementById('adminLoginSection');
        const signalsSection = document.getElementById('signalsSection');
        const adminSection = document.getElementById('adminSection');
        const signalsGrid = document.getElementById('signalsGrid');
        const loginBtn = document.getElementById('loginBtn');
        const adminLoginBtn = document.getElementById('adminLoginBtn');
        const adminLoginToggle = document.getElementById('adminLoginToggle');
        const userLoginToggle = document.getElementById('userLoginToggle');
        const logoutBtn = document.getElementById('logoutBtn');
        const paymentModal = document.getElementById('paymentModal');
        const closeModal = document.getElementById('closeModal');
        const paymentOptions = document.querySelectorAll('.payment-option');
        const confirmPayment = document.getElementById('confirmPayment');
        const admin1Contact = document.getElementById('admin1Contact');
        const admin2Contact = document.getElementById('admin2Contact');
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        const totalUsersEl = document.getElementById('totalUsers');
        const onlineUsersEl = document.getElementById('onlineUsers');
        const activeSignalsEl = document.getElementById('activeSignals');
        const successRateEl = document.getElementById('successRate');
        const onlineUsersList = document.getElementById('onlineUsersList');
        const addUserBtn = document.getElementById('addUserBtn');
        const editUserBtn = document.getElementById('editUserBtn');
        const removeUserBtn = document.getElementById('removeUserBtn');
        const resetPasswordBtn = document.getElementById('resetPasswordBtn');
        const addSignalBtn = document.getElementById('addSignalBtn');
        const editSignalBtn = document.getElementById('editSignalBtn');
        const removeSignalBtn = document.getElementById('removeSignalBtn');
        const exportDataBtn = document.getElementById('exportDataBtn');
        
        // Global variables
        let currentUser = null;
        let isUserAdmin = false;
        let signals = [];
        let users = [];
        let deletionCheckInterval = null;
        let currentSessionId = null;

        // Generate a unique session ID
        function generateSessionId() {
            return 'session-' + Math.random().toString(36).substr(2, 9) + '-' + Date.now();
        }

        // Initialize Firebase and load data
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user is already logged in
            auth.onAuthStateChanged(async user => {
                if (user) {
                    currentUser = user;
                    currentSessionId = localStorage.getItem('sessionId');
                    
                    // If no session ID, generate a new one
                    if (!currentSessionId) {
                        currentSessionId = generateSessionId();
                        localStorage.setItem('sessionId', currentSessionId);
                    }
                    
                    // Check if user is admin - this is the critical fix
                    try {
                        const userDoc = await db.collection('users').doc(user.uid).get();
                        isUserAdmin = userDoc.exists && userDoc.data().role === 'admin';
                        
                        // Update session ID for admin
                        if (isUserAdmin) {
                            await db.collection('users').doc(user.uid).update({
                                currentSessionId: currentSessionId,
                                lastLogin: new Date()
                            });
                        }
                    } catch (error) {
                        console.error("Error checking admin status:", error);
                        isUserAdmin = false;
                    }
                    
                    // Redirect to appropriate section
                    if (isUserAdmin) {
                        loginSection.classList.add('hidden');
                        adminLoginSection.classList.add('hidden');
                        signalsSection.classList.add('hidden');
                        adminSection.classList.remove('hidden');
                        logoutBtn.classList.remove('hidden');
                        initAdminStats();
                    } else {
                        loginSection.classList.add('hidden');
                        adminLoginSection.classList.add('hidden');
                        signalsSection.classList.remove('hidden');
                        adminSection.classList.add('hidden');
                        logoutBtn.classList.remove('hidden');
                        loadSignals();
                    }
                } else {
                    // Clear any existing deletion check
                    if (deletionCheckInterval) {
                        clearInterval(deletionCheckInterval);
                        deletionCheckInterval = null;
                    }
                }
            });
        });

        // START DELETION CHECK (ONLY FOR NON-ADMIN USERS)
        function startDeletionCheck() {
            // Clear any existing interval
            if (deletionCheckInterval) {
                clearInterval(deletionCheckInterval);
            }
            
            // Check every 15 seconds if account has been deleted
            deletionCheckInterval = setInterval(() => {
                if (!currentUser) return;
                
                // Check if user document exists
                db.collection('users').doc(currentUser.uid).get()
                    .then(doc => {
                        if (!doc.exists) {
                            // User document doesn't exist - force logout
                            forceLogout("Your account has been removed by an administrator.");
                        } else {
                            // Check if session is valid
                            const userData = doc.data();
                            if (userData.currentSessionId && userData.currentSessionId !== currentSessionId) {
                                // Another device is using the same account
                                forceLogout("This account is already in use on another device. Only one device is allowed per account.");
                            }
                        }
                    })
                    .catch(error => {
                        console.error("Error checking user document:", error);
                        // Only log out if it's a permission error (which means account was removed)
                        if (error.code === 'permission-denied') {
                            forceLogout("Your account has been removed by an administrator.");
                        }
                    });
            }, 15000); // Check every 15 seconds
        }

        // FORCE LOGOUT FUNCTION
        function forceLogout(message = "You have been logged out.") {
            if (message) {
                alert(message);
            }
            
            // Clear any deletion check
            if (deletionCheckInterval) {
                clearInterval(deletionCheckInterval);
                deletionCheckInterval = null;
            }
            
            // Sign out from Firebase
            auth.signOut().then(() => {
                currentUser = null;
                isUserAdmin = false;
                signalsSection.classList.add('hidden');
                adminSection.classList.add('hidden');
                loginSection.classList.remove('hidden');
                logoutBtn.classList.add('hidden');
                localStorage.removeItem('sessionId');
            }).catch(error => {
                console.error("Error during forced logout:", error);
                // Even if signOut fails, reset the UI
                currentUser = null;
                isUserAdmin = false;
                signalsSection.classList.add('hidden');
                adminSection.classList.add('hidden');
                loginSection.classList.remove('hidden');
                logoutBtn.classList.add('hidden');
                localStorage.removeItem('sessionId');
            });
        }

        // Toggle admin login
        adminLoginToggle.addEventListener('click', function() {
            loginSection.classList.add('hidden');
            adminLoginSection.classList.remove('hidden');
        });

        // Toggle user login
        userLoginToggle.addEventListener('click', function() {
            adminLoginSection.classList.add('hidden');
            loginSection.classList.remove('hidden');
        });

        // User login
        loginBtn.addEventListener('click', function() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (username && password) {
                // In a real app, you'd validate credentials against Firebase
                // For demo purposes, we'll just log in as a regular user
                auth.signInWithEmailAndPassword(`${username}@example.com`, password)
                    .then(userCredential => {
                        currentUser = userCredential.user;
                        isUserAdmin = false;
                        
                        // Generate a new session ID
                        currentSessionId = generateSessionId();
                        localStorage.setItem('sessionId', currentSessionId);
                        
                        // Update user document with current session ID
                        db.collection('users').doc(currentUser.uid).update({
                            currentSessionId: currentSessionId,
                            lastLogin: new Date()
                        }).catch(error => {
                            console.error("Error updating session ID:", error);
                        });
                        
                        loginSection.classList.add('hidden');
                        signalsSection.classList.remove('hidden');
                        logoutBtn.classList.remove('hidden');
                        loadSignals();
                    })
                    .catch(error => {
                        // Handle specific errors
                        if (error.code === 'auth/user-not-found') {
                            paymentModal.classList.add('active');
                        } else if (error.code === 'auth/wrong-password') {
                            alert('Incorrect password. Please try again.');
                        } else {
                            console.error("Login error:", error);
                            paymentModal.classList.add('active');
                        }
                    });
            } else {
                alert('Please enter both username and password');
            }
        });

        // Admin login
        adminLoginBtn.addEventListener('click', function() {
            const username = document.getElementById('adminUsername').value;
            const password = document.getElementById('adminPassword').value;
            
            // In a real app, you'd use proper authentication
            // For demo, we'll check if it's the admin account
            if (username === 'admin' && password === 'admin123') {
                auth.signInWithEmailAndPassword('admin@kingpinpips.com', 'admin123')
                    .then(userCredential => {
                        currentUser = userCredential.user;
                        isUserAdmin = true;
                        
                        // Generate a new session ID
                        currentSessionId = generateSessionId();
                        localStorage.setItem('sessionId', currentSessionId);
                        
                        // Update user document with current session ID
                        db.collection('users').doc(currentUser.uid).update({
                            currentSessionId: currentSessionId,
                            lastLogin: new Date()
                        }).catch(error => {
                            console.error("Error updating session ID:", error);
                        });
                        
                        adminLoginSection.classList.add('hidden');
                        adminSection.classList.remove('hidden');
                        logoutBtn.classList.remove('hidden');
                        initAdminStats();
                    })
                    .catch(error => {
                        // Create admin account if it doesn't exist
                        if (error.code === 'auth/user-not-found') {
                            auth.createUserWithEmailAndPassword('admin@kingpinpips.com', 'admin123')
                                .then(userCredential => {
                                    currentUser = userCredential.user;
                                    isUserAdmin = true;
                                    
                                    // Generate a new session ID
                                    currentSessionId = generateSessionId();
                                    localStorage.setItem('sessionId', currentSessionId);
                                    
                                    // Add user to users collection
                                    db.collection('users').doc(userCredential.user.uid).set({
                                        username: 'admin',
                                        createdAt: new Date(),
                                        lastLogin: new Date(),
                                        role: 'admin',
                                        currentSessionId: currentSessionId
                                    }).then(() => {
                                        adminLoginSection.classList.add('hidden');
                                        adminSection.classList.remove('hidden');
                                        logoutBtn.classList.remove('hidden');
                                        initAdminStats();
                                    }).catch(error => {
                                        console.error("Error creating admin document:", error);
                                        alert('Error logging in as admin');
                                    });
                                })
                                .catch(error => {
                                    console.error("Error creating admin:", error);
                                    alert('Error logging in as admin');
                                });
                        } else if (error.code === 'auth/wrong-password') {
                            alert('Incorrect admin password. Please try again.');
                        } else {
                            console.error("Admin login error:", error);
                            alert('Invalid admin credentials');
                        }
                    });
            } else {
                alert('Invalid admin credentials');
            }
        });

        // Logout
        logoutBtn.addEventListener('click', function() {
            // Clear session ID from user document
            if (currentUser) {
                db.collection('users').doc(currentUser.uid).update({
                    currentSessionId: firebase.firestore.FieldValue.delete()
                }).catch(error => {
                    console.error("Error clearing session ID:", error);
                });
            }
            
            auth.signOut().then(() => {
                currentUser = null;
                isUserAdmin = false;
                signalsSection.classList.add('hidden');
                adminSection.classList.add('hidden');
                loginSection.classList.remove('hidden');
                logoutBtn.classList.add('hidden');
                
                // Clear deletion check
                if (deletionCheckInterval) {
                    clearInterval(deletionCheckInterval);
                    deletionCheckInterval = null;
                }
                
                localStorage.removeItem('sessionId');
            }).catch(error => {
                console.error("Logout error:", error);
            });
        });

        // Close modal
        closeModal.addEventListener('click', function() {
            paymentModal.classList.remove('active');
        });

        // Payment option selection
        paymentOptions.forEach(option => {
            option.addEventListener('click', function() {
                paymentOptions.forEach(opt => opt.classList.remove('selected'));
                this.classList.add('selected');
            });
        });

        // Confirm payment
        confirmPayment.addEventListener('click', function() {
            const selectedOption = document.querySelector('.payment-option.selected');
            if(selectedOption) {
                alert('Please contact an admin via WhatsApp to complete your payment and account activation.');
                paymentModal.classList.remove('active');
            } else {
                alert('Please select a package first.');
            }
        });

        // Admin contact
        admin1Contact.addEventListener('click', function() {
            const packageText = document.querySelector('.payment-option.selected h4')?.textContent || 'package';
            const username = document.getElementById('username').value || 'New User';
            const message = `Hello, I want to purchase the ${packageText} package for Kingpin Pips Signals. My username is: ${username}. Please activate my account.`;
            window.open(`https://wa.me/263782637207?text=${encodeURIComponent(message)}`, '_blank');
        });

        admin2Contact.addEventListener('click', function() {
            const packageText = document.querySelector('.payment-option.selected h4')?.textContent || 'package';
            const username = document.getElementById('username').value || 'New User';
            const message = `Hello, I want to purchase the ${packageText} package for Kingpin Pips Signals. My username is: ${username}. Please activate my account.`;
            window.open(`https://wa.me/263778652739?text=${encodeURIComponent(message)}`, '_blank');
        });

        // Tab switching
        tabs.forEach(tab => {
            tab.addEventListener('click', function() {
                const tabName = this.getAttribute('data-tab');
                // Update active tab
                tabs.forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                // Show active content
                tabContents.forEach(content => {
                    content.classList.remove('active');
                    if(content.id === `${tabName}Tab`) {
                        content.classList.add('active');
                    }
                });
            });
        });

        // Admin control buttons
        addUserBtn.addEventListener('click', function() {
            const username = prompt('Enter new username:');
            if(username) {
                const password = prompt('Enter password for this user:');
                if (password) {
                    // Create user in Firebase
                    auth.createUserWithEmailAndPassword(`${username}@example.com`, password)
                        .then(userCredential => {
                            // Add user to users collection
                            db.collection('users').doc(userCredential.user.uid).set({
                                username: username,
                                createdAt: new Date(),
                                lastLogin: new Date(),
                                role: 'user'
                            }).then(() => {
                                alert(`User ${username} added successfully!`);
                                loadUsers();
                            }).catch(error => {
                                console.error("Error adding user document: ", error);
                                alert(`User created but error saving user document: ${error.message}`);
                            });
                        })
                        .catch(error => {
                            console.error("Error creating user: ", error);
                            alert(`Error creating user: ${error.message}`);
                        });
                }
            }
        });

        editUserBtn.addEventListener('click', function() {
            if (!users || users.length === 0) {
                alert('No users available to edit');
                return;
            }
            
            // Create a prompt to select user
            let userOptions = 'Select a user by number:\n';
            users.forEach((user, index) => {
                userOptions += `${index + 1}. ${user.username}\n`;
            });
            
            const selection = prompt(userOptions);
            const selectedIndex = parseInt(selection) - 1;
            
            if (selectedIndex >= 0 && selectedIndex < users.length) {
                const selectedUser = users[selectedIndex];
                const newUsername = prompt('Enter new username (leave blank to keep current):', selectedUser.username);
                const newPassword = prompt('Enter new password (leave blank to keep current):');
                
                // Update username in Firestore
                if (newUsername && newUsername !== selectedUser.username) {
                    db.collection('users').doc(selectedUser.id).update({
                        username: newUsername
                    }).then(() => {
                        alert(`Username updated to ${newUsername}`);
                        loadUsers();
                    }).catch(error => {
                        console.error("Error updating username: ", error);
                        alert(`Error updating username: ${error.message}`);
                    });
                }
                
                // Update password
                if (newPassword) {
                    // In a real app, you'd handle password reset properly
                    // This is simplified for demo
                    auth.sendPasswordResetEmail(`${selectedUser.username}@example.com}`)
                        .then(() => {
                            alert(`Password reset email sent to ${selectedUser.username}@example.com}`);
                        })
                        .catch(error => {
                            console.error("Error sending password reset: ", error);
                            alert(`Error sending password reset: ${error.message}`);
                        });
                }
            } else {
                alert('Invalid selection');
            }
        });

        removeUserBtn.addEventListener('click', function() {
            if (!users || users.length === 0) {
                alert('No users available to remove');
                return;
            }
            
            // Create a prompt to select user
            let userOptions = 'Select a user by number:\n';
            users.forEach((user, index) => {
                userOptions += `${index + 1}. ${user.username}\n`;
            });
            
            const selection = prompt(userOptions);
            const selectedIndex = parseInt(selection) - 1;
            
            if (selectedIndex >= 0 && selectedIndex < users.length) {
                const selectedUser = users[selectedIndex];
                
                if (confirm(`Are you sure you want to remove user ${selectedUser.username}?`)) {
                    // Delete from Firestore
                    db.collection('users').doc(selectedUser.id).delete()
                        .then(() => {
                            alert(`User ${selectedUser.username} removed successfully!`);
                            loadUsers();
                        })
                        .catch(error => {
                            console.error("Error removing user: ", error);
                            alert(`Error removing user: ${error.message}`);
                        });
                }
            } else {
                alert('Invalid selection');
            }
        });

        resetPasswordBtn.addEventListener('click', function() {
            if (!users || users.length === 0) {
                alert('No users available');
                return;
            }
            
            // Create a prompt to select user
            let userOptions = 'Select a user by number:\n';
            users.forEach((user, index) => {
                userOptions += `${index + 1}. ${user.username}\n`;
            });
            
            const selection = prompt(userOptions);
            const selectedIndex = parseInt(selection) - 1;
            
            if (selectedIndex >= 0 && selectedIndex < users.length) {
                const selectedUser = users[selectedIndex];
                
                auth.sendPasswordResetEmail(`${selectedUser.username}@example.com}`)
                    .then(() => {
                        alert(`Password reset email sent to ${selectedUser.username}@example.com}`);
                    })
                    .catch(error => {
                        console.error("Error sending password reset: ", error);
                        alert(`Error sending password reset: ${error.message}`);
                    });
            } else {
                alert('Invalid selection');
            }
        });

        // Signal Management Buttons
        addSignalBtn.addEventListener('click', function() {
            const name = prompt('Signal name (e.g., Boom 1000):');
            if (!name) return;
            
            const status = prompt('Status (Open/Closed):', 'Open');
            const action = prompt('Action (Buy/Sell):', 'Sell');
            const tpLevel = prompt('Take Profit Level:', '1.1200');
            const slLevel = prompt('Stop Loss Level:', '1.1350');
            
            const signal = {
                name: name,
                status: status,
                action: action,
                time: new Date().toLocaleString(),
                tpLevel: tpLevel,
                slLevel: slLevel,
                tpHit: false,
                slHit: false,
                createdAt: new Date()
            };
            
            // Add to Firestore
            db.collection('signals').add(signal)
                .then(() => {
                    alert('Signal added successfully!');
                    loadSignals();
                })
                .catch(error => {
                    console.error("Error adding signal: ", error);
                    alert(`Error adding signal: ${error.message}`);
                });
        });

        editSignalBtn.addEventListener('click', function() {
            if (!signals || signals.length === 0) {
                alert('No signals available to edit');
                return;
            }
            
            // Create a prompt to select signal
            let signalOptions = 'Select a signal by number:\n';
            signals.forEach((signal, index) => {
                signalOptions += `${index + 1}. ${signal.name} (${signal.status})\n`;
            });
            
            const selection = prompt(signalOptions);
            const selectedIndex = parseInt(selection) - 1;
            
            if (selectedIndex >= 0 && selectedIndex < signals.length) {
                const selectedSignal = signals[selectedIndex];
                
                const name = prompt('Signal name:', selectedSignal.name);
                const status = prompt('Status (Open/Closed):', selectedSignal.status);
                const action = prompt('Action (Buy/Sell):', selectedSignal.action);
                const tpLevel = prompt('Take Profit Level:', selectedSignal.tpLevel);
                const slLevel = prompt('Stop Loss Level:', selectedSignal.slLevel);
                
                const updatedSignal = {
                    name: name,
                    status: status,
                    action: action,
                    time: new Date().toLocaleString(),
                    tpLevel: tpLevel,
                    slLevel: slLevel
                };
                
                // Update in Firestore
                db.collection('signals').doc(selectedSignal.id).update(updatedSignal)
                    .then(() => {
                        alert('Signal updated successfully!');
                        loadSignals();
                    })
                    .catch(error => {
                        console.error("Error updating signal: ", error);
                        alert(`Error updating signal: ${error.message}`);
                    });
            } else {
                alert('Invalid selection');
            }
        });

        removeSignalBtn.addEventListener('click', function() {
            if (!signals || signals.length === 0) {
                alert('No signals available to remove');
                return;
            }
            
            // Create a prompt to select signal
            let signalOptions = 'Select a signal by number:\n';
            signals.forEach((signal, index) => {
                signalOptions += `${index + 1}. ${signal.name} (${signal.status})\n`;
            });
            
            const selection = prompt(signalOptions);
            const selectedIndex = parseInt(selection) - 1;
            
            if (selectedIndex >= 0 && selectedIndex < signals.length) {
                const selectedSignal = signals[selectedIndex];
                
                if (confirm(`Are you sure you want to remove signal ${selectedSignal.name}?`)) {
                    // Delete from Firestore
                    db.collection('signals').doc(selectedSignal.id).delete()
                        .then(() => {
                            alert('Signal removed successfully!');
                            loadSignals();
                        })
                        .catch(error => {
                            console.error("Error removing signal: ", error);
                            alert(`Error removing signal: ${error.message}`);
                        });
                }
            } else {
                alert('Invalid selection');
            }
        });

        exportDataBtn.addEventListener('click', function() {
            // Get all signals
            db.collection('signals').get()
                .then(querySnapshot => {
                    const exportData = [];
                    querySnapshot.forEach(doc => {
                        exportData.push(doc.data());
                    });
                    
                    // Create CSV content
                    let csvContent = "text/csv;charset=utf-8,";
                    csvContent += "Name,Status,Action,Time,TP Level,SL Level\n";
                    
                    exportData.forEach(signal => {
                        csvContent += `${signal.name},${signal.status},${signal.action},${signal.time},${signal.tpLevel},${signal.slLevel}\n`;
                    });
                    
                    // Create download link
                    const encodedUri = encodeURI(csvContent);
                    const link = document.createElement("a");
                    link.setAttribute("href", encodedUri);
                    link.setAttribute("download", "kingpin_signals_export_" + new Date().toISOString().slice(0,10) + ".csv");
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    alert('Signal data exported successfully!');
                })
                .catch(error => {
                    console.error("Error exporting  ", error);
                    alert(`Error exporting  ${error.message}`);
                });
        });

        // Load signals from Firestore
        function loadSignals() {
            db.collection('signals').orderBy('createdAt', 'desc').get()
                .then(querySnapshot => {
                    signals = [];
                    querySnapshot.forEach(doc => {
                        const signal = doc.data();
                        signal.id = doc.id;
                        signals.push(signal);
                    });
                    
                    // Update active signals count in admin panel if visible
                    if (!adminSection.classList.contains('hidden')) {
                        activeSignalsEl.textContent = signals.filter(s => s.status === 'Open').length;
                    }
                    
                    generateSignalCards();
                })
                .catch(error => {
                    console.error("Error loading signals: ", error);
                    alert(`Error loading signals: ${error.message}`);
                });
        }

        // Generate signal cards
        function generateSignalCards() {
            signalsGrid.innerHTML = '';
            signals.forEach(signal => {
                const card = document.createElement('div');
                card.className = 'signal-card';
                card.innerHTML = `
                    <div class="signal-header">
                        <div class="signal-name">${signal.name}</div>
                        <div class="signal-status status-${signal.status.toLowerCase()}">${signal.status}</div>
                    </div>
                    <div class="signal-details">
                        <div class="detail-item">
                            <span class="detail-label">Profit/Loss</span>
                            <span class="detail-value ${signal.profitLoss ? signal.profitLoss.toLowerCase() : ''}">${signal.profitLoss || 'Pending'}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Action</span>
                            <span class="detail-value ${signal.action.toLowerCase()}">${signal.action}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">TP Level</span>
                            <span class="detail-value">${signal.tpLevel}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">SL Level</span>
                            <span class="detail-value">${signal.slLevel}</span>
                        </div>
                    </div>
                    <div class="signal-hits">
                        <div class="hit-item tp-hit">TP Hit: ${signal.tpHit ? 'YES' : 'NO'}</div>
                        <div class="hit-item sl-hit">SL Hit: ${signal.slHit ? 'YES' : 'NO'}</div>
                    </div>
                    <div class="signal-time">
                        <i class="far fa-clock"></i> ${signal.time}
                    </div>
                `;
                signalsGrid.appendChild(card);
            });
        }

        // Load users from Firestore
        function loadUsers() {
            db.collection('users').get()
                .then(querySnapshot => {
                    users = [];
                    querySnapshot.forEach(doc => {
                        const user = doc.data();
                        user.id = doc.id;
                        users.push(user);
                    });
                    
                    // Update stats
                    totalUsersEl.textContent = users.length;
                    onlineUsersEl.textContent = Math.floor(users.length * 0.7); // 70% online for demo
                    
                    generateOnlineUsers();
                })
                .catch(error => {
                    console.error("Error loading users: ", error);
                });
        }

        // Generate online users list
        function generateOnlineUsers() {
            onlineUsersList.innerHTML = '';
            const onlineCount = Math.min(8, users.length);
            const selectedUsers = users.slice(0, onlineCount);
            
            selectedUsers.forEach(user => {
                const badge = document.createElement('div');
                badge.className = 'user-badge';
                badge.textContent = user.username;
                onlineUsersList.appendChild(badge);
            });
        }

        // Initialize admin stats
        function initAdminStats() {
            loadUsers();
            loadSignals();
            
            // Calculate success rate
            const totalSignals = signals.length;
            const closedSignals = signals.filter(s => s.status === 'Closed').length;
            const profitableSignals = signals.filter(s => s.status === 'Closed' && s.profitLoss === 'Profit').length;
            
            const successRate = closedSignals > 0 ? Math.round((profitableSignals / closedSignals) * 100) : 0;
            successRateEl.textContent = `${successRate}%`;
            
            activeSignalsEl.textContent = signals.filter(s => s.status === 'Open').length;
        }

        // Close modal when clicking outside
        window.addEventListener('click', function(event) {
            if (event.target === paymentModal) {
                paymentModal.classList.remove('active');
            }
        });
    </script>
</body>
</html>
